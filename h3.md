# h3 No Strings Attached

## a) Strings: Extracting Data from passtr
The goal of this task was to analyze the ``passtr`` binary to find a hidden password and flag using static analysis.

- First, I downloaded the ``ezbin-challenges.zip`` and navigated to the directory:

- I typed this command on my terminal
```
unzip ezbin-challenges.zip
cd challenges/passtr
```
- I ran the ``pastr`` script as seen below:
 
 ```
./passtr
```

- I was prompted for a password. Providing incorrect input resulted in a "Sorry, no bonus" message, confirming the binary validates input against a hardcoded value.
  
<img width="804" height="119" alt="Screenshot 2026-02-01 at 8 40 38 AM" src="https://github.com/user-attachments/assets/56121c58-2831-4631-81d2-6fd196ee1926" />

- So then I utilized the ``strings`` command, which scans the binary for sequences of printable characters.

- On my termial I typed:

```
  strings passtr
```

- There were many lines of charachters but luckily the password was very clear, as it shows in the screenshot below:
  
<img width="940" height="136" alt="Screenshot 2026-02-01 at 8 39 51 AM" src="https://github.com/user-attachments/assets/63cfc9fb-a65b-49ac-9624-f69b7030d202" />

- The password appeared to be: sala-hakkeri-321
- So I ran the previous script again ``./paastr``, and entered the password. Here was the successful result as shown below!
  
<img width="914" height="132" alt="Screenshot 2026-02-01 at 8 39 15 AM" src="https://github.com/user-attachments/assets/a0866580-ed71-4b73-a574-9a3fde0d74e6" />
---

## b) Obfuscation: Securing passtr.c

- The original source code stored the password and flag in plaintext.
- To improve security, I would need to create a version where the password is not stored as a literal string, making it invisible to the strings command.
- I researched various methods and discovered that a common technique is to use **XOR cipher** which stores data in a "scrambled" state and only unscramble it at the moment of comparison.


C
#include <stdio.h>
#include <string.h>
```
#include <stdio.h>
#include <string.h>

int main() {
    // These are the bytes for "sala-hakkeri-321" XORed with 0x1F
    // No "sala" string exists here!
    unsigned char obfuscated[] = {0x43, 0x51, 0x54, 0x51, 0x12, 0x58, 0x51, 0x5b, 0x5b, 0x55, 0x42, 0x59, 0x12, 0x23, 0x22, 0x21, 0x00};
    unsigned char key = 0x1F; 
    char input[20];

    printf("What's the password?\n");
    scanf("%19s", input);

    // We encode the user's input and compare it to our hidden bytes
    int match = 1;
    for (int i = 0; i < 16; i++) {
        if ((input[i] ^ (unsigned char)key) != obfuscated[i]) {
            match = 0;
            break;
        }
    }

    if (match && strlen(input) == 16) {
        printf("Yes! That's the password. FLAG{Tero-d75ee66af0a68663f15}\n");
    } else {
        printf("Sorry, no bonus.\n");
    }

    return 0;
}
```


